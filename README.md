# SCache — атрибутивно-сегментный кэш

## Состав репозитория

Репозиторий включает в себя 4 основных каталога:

* `src` — исходные коды кэшей, _симулятора_ и _генератора_
* `examples` — примеры исходных данных для повторения экспериментов,
описанных в дипломной работе
* `log` — в этот каталог будут складываться логи запусков всех программ;
* `text` — здесь находятся исходные данные текста работы (в формате LaTeX).

Также корневой каталог содержит файл `Text.pdf` с полным текстом работы.

### Состав каталога `src`

В каталоге `src` находятся два подкаталога: `SCache` и `Generator`.

Каталог `SCache` содержит исходные коды программ `lru` и `scache`,
представляющие собой симуляторы соответствующих кэшей.

Для сборки исходных кодов необходимо выполнить команду `make`, либо
`make scache` или `make lru` для сборки одного из указанных симуляторов.

Для очистки собранных данных используется команда `make clean`.

### Состав каталога `examples`

В каталоге `examples` находится подкаталог `ini`, а также
два файла — `table.txt` и `table_short.txt`.

* В подткаталоге `ini` находятся конфигурационные файлы для генератора,
которые были использованы для создания наборов, описанных в работе;
* `table.txt` — таблица атрибутов;
* `table_short.txt` — сокращённая таблица атрибутов, содержащая меньшее
количество объектов (для ускоренных экспериментов)

## Проведение экспериментов

Для проведения экспериментов с имеющимися данными необходимо проделать
следующие шаги:

1. С помощью генератора из конфигурационных файлов создать наборы данных для
симуляции (датасеты);
2. Запустить симуляторы кэшей на созданных датасетах.

### Запуск приложений

В скобках указаны параметры, которые использовались в работе.

1. Запуск симулятора LRU: `./lru size dataset`, где:
	* `size` — размер кэша с двоичными приставками (например, `56G`);
	* `dataset` — путь к набору данных, созданному генератором.

2. Запуск симулятора SCache: `./scache size seg_count min_size depth
slot_length slot_count attrib_table dataset`, где:
	* `size` и `dataset` — см. выше;
	* `seg_count` — максимальное число сегментов (10);
	* `min_size` — минимальная доля кэша, которую может занимать сегмент
		(0);
	* `depth` — максимальное число атрибутов, по которым строится мотив (1);
	* `slot_length` — длина одного слота __в минутах__ (15);
	* `slot_count` — число слотов в цикле (96);
	* `attrib_table` — путь к таблице атрибутов.

3. Запуск генератора.

Генератор может работать в трёх режимах: одиночном, пакетном и
интерактивном. Для проверки результатов тестирования на имеющихся данных
рекомендуется использовать __интерактивный__ режим — для этого генератор
запускается __без аргументов__ командной строки
(информация о командах выводится при запуске приложения).

### Создание собственных данных

Помимо повторения описанных в работе экспериментов, можно проводить
собственные тесты. Для этого требуется описать свои конфигурационные файлы,
и, опционально, собственную таблицу атрибутов.

#### Формат ini-файла

Файл конфигурации генератора подразделяется на __секции__, каждая из
которых соответствует тому или иному мотиву. Секций может быть сколько
угодно. Формат секции следующий:
```ini
[attributes]
period=P
length=L
attack=A
shift=S
volume=V
```

* `attributes` — атрибуты мотива. Задаётся в формате `'key1'='value1',
'key2'='value2',...,'keyN'='valueN'` (кавычки обязательны). Задаёт
множество объектов, которые будут создаваться в этом мотиве
* `period`, `length`, `attack` и `shift` задают временное распределение
мотива согласно описанию в тексте работы. Они устанавливаются __диапазоном
времени__ в формате `L~R`, где `L` и `R` — левая и правая границы диапазона
соответственно, и каждая граница имеет формат `Nh` где `N` — целое число,
`h` — единица измерения, одна из следующих:
	* `s` — секунды;
	* `m` — минуты;
	* `h` — часы;
	* `d` — дни;
	* `w` — недели.

Пример описания диапазона времени: `30m~2h` (от 30 минут до 2 часов).

* `volume` — объём итерации мотива, задаётся __диапазоном размера__,
аналогично диапазону времени, но с другими единицами измерения:
	* `k` — КБайт;
	* `m` — МБайт;
	* `g` — ГБайт;
	* `t` — ТБайт.

P. S. Используются __двоичные__ множители (1 МБайт = 1024 КБайт).

#### Формат таблицы атрибутов

Сама таблица имеет формат описания JSON. Описывается она следующим образом:

```python3
{
	'id1':{
		'key1':'value1',
		'key2':['value2a', 'value2b', ...],
		...
		'size':'SIZE'
	},
	'id2':{
		...
	},
	...
}
```

`idN` задают __идентификаторы объектов__, `keyN` — имена атрибутов,
`valueN` — значения атрибутов.

Примечания:
* Наружные фигурные скобки __обязательны__;
* Все элементы таблицы — __строки__;
* У каждого объекта __должен__ быть атрибут `size`, значением которого
является строка, содержащая __целое__ число — размер объекта __в КБ__;
* Все остальные строки могут содержать любые значения;
* Наличие запятой после последнего элемента не влияет на работу таблицы.
